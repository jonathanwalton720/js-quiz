<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Quiz</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script type="application/javascript" src="quiz.js"></script>
</head>
<body>
<div class="container">
    <div>
        <p id="question" class="lead"></p>
    </div>
    <div id="answers" class="radio"></div>
    <div>
        <button id="previous" class="btn" type="button" disabled>Previous</button>
        <button id="next" class="btn" type="button">Next</button>
        <button id="scoreQuiz" class="btn" type="button" disabled>Score Quiz</button>
    </div>
    <div id="scoreReport"></div>
</div>
<script>
    var currentQuestion = 0;
    var question = document.getElementById('question');
    var answers = document.getElementById('answers');
    var next = document.getElementById('next');
    var previous = document.getElementById('previous');
    var maxQuestion = allQuestions.length - 1;
    var selectedAnswers = {};
    var scoreQuiz = document.getElementById('scoreQuiz');

    function goToQuestion (questionNumber) {
        var isLastQuestion = currentQuestion == maxQuestion;

        answers.innerHTML = "";
        previous.disabled = currentQuestion == 0;
        next.disabled = isLastQuestion;
        if (isLastQuestion) {
            scoreQuiz.disabled = false;
        }

        question.innerHTML = allQuestions[questionNumber].question;

        var choices = allQuestions[questionNumber].choices;
        for (var i = 0; i < choices.length; i++) {
            var div = document.createElement('div');
            var answer = document.createElement('input');
            var label = document.createElement('label');
            var answerText = document.createElement('span');
            var answerId = 'answer' + i;

            div.className = 'radio';

            answer.id = answerId;
            answer.name = 'answers';
            answer.type = 'radio';
            answer.value = i;

            label.setAttribute('for', answerId);

            answerText.innerHTML = choices[i];

            answers.appendChild(div);
            div.appendChild(label);
            label.appendChild(answer);
            label.appendChild(answerText);

        }

        if (selectedAnswers[questionNumber]) {
            var selectedValue = selectedAnswers[questionNumber];
            var radioList = answers.getElementsByTagName('input');
            radioList[selectedValue].checked = true;
        }

    }

    function getSelectedAnswer(radioContainer) {
        var radioList = radioContainer.getElementsByTagName('input');
        for (var i = 0; i < radioList.length; i++) {
            if (radioList[i].checked) {
                return radioList[i].value;
                break;
            }
        }
        return null;
    }

    function getCorrectAnswers() {
        var numCorrect = 0;
        for (var answer in selectedAnswers) {
            var answerValue = selectedAnswers[answer];
            if (allQuestions[answer].correctAnswer == answerValue) {
                numCorrect += 1;
            }
        }
        return numCorrect;
    }

    next.onclick = function() {
        selectedAnswers[currentQuestion] = getSelectedAnswer(answers);
        currentQuestion += 1;
        goToQuestion(currentQuestion);
    }

    previous.onclick = function() {
        selectedAnswers[currentQuestion] = getSelectedAnswer(answers);
        currentQuestion -= 1;
        goToQuestion(currentQuestion);
    }

    scoreQuiz.onclick = function() {
        selectedAnswers[currentQuestion] = getSelectedAnswer(answers);
        scoreReport.innerHTML = "";

        var numCorrect = getCorrectAnswers();
        var scoreReport = document.getElementById("scoreReport");
        var scoreHeader = document.createElement("p");
        var scoreBody = document.createElement("p");

        scoreHeader.className = "lead";
        scoreHeader.innerHTML = "Score Report";
        scoreBody.innerHTML = "You have answered " + numCorrect + " out of " + maxQuestion + " correct!";
        scoreReport.appendChild(scoreHeader);
        scoreReport.appendChild(scoreBody);
    }

    goToQuestion(currentQuestion);

</script>
</body>
</html>